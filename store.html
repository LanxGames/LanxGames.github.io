<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All Games - LANX GAMES.LK</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* CSS Design - Black & White Premium Theme */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { background-color: #000000; color: #ffffff; line-height: 1.6; overflow-x: hidden; }

        /* Skeleton Loading */
        .skeleton { background: linear-gradient(90deg, #0a0a0a 25%, #1a1a1a 50%, #0a0a0a 75%); background-size: 200% 100%; animation: skeleton-shimmer 1.5s infinite linear; border-radius: 4px; }
        @keyframes skeleton-shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
        .skeleton-card { width: calc(20% - 12px); height: 400px; background: #0a0a0a; border: 1px solid #1a1a1a; padding: 15px; border-radius: 4px; display: flex; flex-direction: column; }
        .sk-img { width: 100%; height: 280px; margin-bottom: 15px; }
        .sk-title { width: 80%; height: 15px; margin-bottom: 10px; align-self: center; }

        /* Header & Logo */
        header { padding: 25px 8%; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid rgba(255,255,255,0.05); background: rgba(0,0,0,0.8); backdrop-filter: blur(15px); position: sticky; top: 0; z-index: 2000; }
        .logo-box { width: 60px; height: 60px; border: 2px solid #fff; display: flex; justify-content: center; align-items: center; clip-path: polygon(15% 0, 100% 0, 100% 85%, 85% 100%, 0 100%, 0 15%); }
        .logo-box::after { content: 'LANX'; font-weight: 900; font-size: 13px; letter-spacing: 2px; }
        .brand-name { font-size: 26px; font-weight: 900; letter-spacing: 4px; text-transform: uppercase; }

        /* User Auth Area */
        .user-nav-area { display: flex; align-items: center; gap: 12px; cursor: pointer; padding: 8px 22px; border-radius: 50px; border: 1px solid rgba(255,255,255,0.2); transition: 0.4s; position: relative; }
        .user-nav-area:hover { background: #fff; color: #000; }
        .user-nav-area img { width: 28px; height: 28px; border-radius: 50%; border: 1px solid #fff; }
        .profile-card { position: absolute; top: 60px; right: 0; width: 250px; background: #000; border: 1px solid #333; border-radius: 15px; padding: 25px; display: none; flex-direction: column; align-items: center; z-index: 5000; }
        .logout-btn-card { background: #fff; color: #000; border: none; padding: 10px; width: 100%; font-weight: bold; cursor: pointer; border-radius: 8px; margin-top: 15px; }

        /* Navigation & Search */
        nav { background: #000; padding: 20px 5%; display: flex; flex-direction: column; align-items: center; gap: 20px; }
        .nav-links { display: flex; list-style: none; gap: 30px; }
        .nav-links a { color: #888; text-decoration: none; font-size: 13px; font-weight: 600; text-transform: uppercase; transition: 0.3s; }
        .nav-links a:hover { color: #fff; }
        .search-wrapper { width: 100%; max-width: 600px; position: relative; }
        .search-bar { width: 100%; background: rgba(255,255,255,0.03); border: 1px solid #222; padding: 15px; color: white; border-radius: 12px; outline: none; text-align: center; }
        .search-dropdown { position: absolute; top: 100%; left: 0; width: 100%; background: #0a0a0a; border: 1px solid #222; border-radius: 0 0 12px 12px; display: none; z-index: 5000; }
        .search-item { display: flex; align-items: center; padding: 10px; border-bottom: 1px solid #111; cursor: pointer; }
        .search-item:hover { background: #111; }
        .search-item img { width: 40px; height: 50px; object-fit: cover; margin-right: 15px; }

        /* Grid System */
        .container { width: 95%; margin: 30px auto; }
        .grid-title { text-align: center; margin-bottom: 30px; letter-spacing: 5px; text-transform: uppercase; font-size: 18px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 25px; }
        .game-grid { display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; }
        .game-item { background: #0a0a0a; border: 1px solid #1a1a1a; border-radius: 4px; overflow: hidden; transition: 0.3s; width: calc(20% - 12px); display: flex; flex-direction: column; }
        .game-item:hover { border-color: #fff; transform: translateY(-5px); }
        .game-item img { width: 100%; height: 280px; object-fit: cover; }
        .game-info { padding: 12px; text-align: center; flex-grow: 1; display: flex; flex-direction: column; justify-content: space-between; }
        .mini-download-btn { margin-top: 10px; padding: 10px; background: #000; border: 1px solid #fff; color: #fff; text-transform: uppercase; font-size: 11px; cursor: pointer; transition: 0.3s; }
        .mini-download-btn:hover { background: #fff; color: #000; }

        /* Timer Overlay */
        #download-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); backdrop-filter: blur(20px); display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 99999; }
        .timer-circle { width: 80px; height: 80px; border: 2px solid #333; border-top: 2px solid #fff; border-radius: 50%; animation: spin 1s linear infinite; display: flex; align-items: center; justify-content: center; }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        /* Pagination */
        .pagination-container { display: flex; justify-content: center; margin-top: 40px; gap: 8px; padding-bottom: 40px; }
        .page-btn { background: #111; color: white; border: 1px solid #333; padding: 8px 16px; cursor: pointer; border-radius: 8px; }
        .page-btn.active { background: #fff; color: #000; }

        /* Responsive */
        @media (max-width: 1024px) { .game-item { width: calc(33.33% - 10px); } }
        @media (max-width: 480px) { .game-item { width: calc(50% - 8px); } .game-item img { height: 220px; } .brand-name { font-size: 15px; } }
    </style>
</head>
<body>

    <div id="download-overlay">
        <div style="text-align: center; color: white;">
            <div class="timer-circle"><span id="seconds-count" style="transform: rotate(-360deg); animation: none; font-weight: bold;">10</span></div>
            <h2 style="margin-top: 20px; letter-spacing: 2px;">VERIFYING DOWNLOAD...</h2>
        </div>
    </div>

    <header>
        <div class="logo-section" style="display: flex; align-items: center; gap: 15px;">
            <div class="logo-box"></div>
            <div class="brand-name">LANX GAMES.LK</div>
        </div>
        <div class="user-nav-area" id="authBtn" onclick="toggleAuth()">
            <img id="userImg" src="https://cdn-icons-png.flaticon.com/512/149/149071.png">
            <span id="userName">LOGIN</span>
            <div class="profile-card" id="profileCard">
                <img id="cardImg" style="width:70px; border-radius:50%;" src="">
                <h4 id="cardName" style="margin-top:10px;">User</h4>
                <p id="cardEmail" style="font-size: 11px; color: #777;"></p>
                <button class="logout-btn-card" onclick="userLogout()">LOGOUT</button>
            </div>
        </div>
    </header>

    <nav>
        <ul class="nav-links">
            <li><a href="index.html">Home</a></li>
            <li><a href="https://cinesubz.lk/" target="_blank">Movies</a></li>
            <li><a href="https://wa.me/94777042735" target="_blank">Contact</a></li>
        </ul>
        <div class="search-wrapper">
            <input type="text" id="storeSearch" class="search-bar" placeholder="üîç Search All Games..." autocomplete="off">
            <div id="searchDropdown" class="search-dropdown"></div>
        </div>
    </nav>

    <div class="container">
        <a href="index.html" style="color: #888; text-decoration: none; font-size: 13px;">‚Üê Back to Home</a>
        <h2 class="grid-title">ALL GAMES</h2>

        <div id="skeleton-loader" style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: center;">
            <script>
                for(let i=0; i<10; i++) {
                    document.write(`<div class="skeleton-card"><div class="skeleton sk-img"></div><div class="skeleton sk-title"></div></div>`);
                }
            </script>
        </div>

        <div class="game-grid" id="gameGrid" style="display: none;"></div>
        <div id="pagination" class="pagination-container"></div>
    </div>

    <footer style="text-align: center; padding: 40px; border-top: 1px solid #111; font-size: 10px; color: #444; letter-spacing: 2px;">
        ¬© 2026 LANX GAMES.LK | ALL RIGHTS RESERVED
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyC0ZqCnq28-bauG3YBb7WrVVNdQgYOGmqg",
            authDomain: "black-store-login.firebaseapp.com",
            databaseURL: "https://black-store-login-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "black-store-login",
            storageBucket: "black-store-login.firebasestorage.app",
            messagingSenderId: "980593701862",
            appId: "1:980593701862:web:eabd842d94a728c2c9c27"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();
        const db = getDatabase(app);

        let allGames = [];
        let currentPage = 1;
        const limit = 20;

        const gameGrid = document.getElementById('gameGrid');
        const paginationBox = document.getElementById('pagination');
        const searchInput = document.getElementById('storeSearch');
        const searchDropdown = document.getElementById('searchDropdown');

        // Fetch Data
        onValue(ref(db, 'games'), (snapshot) => {
            const data = snapshot.val();
            if (data) {
                allGames = Object.keys(data).reverse().map(key => data[key]);
                displayGames(1);
            }
        });

        function displayGames(page) {
            currentPage = page;
            document.getElementById('skeleton-loader').style.display = 'none';
            gameGrid.style.display = 'flex';
            gameGrid.innerHTML = '';
            
            const start = (page - 1) * limit;
            const currentItems = allGames.slice(start, start + limit);

            currentItems.forEach(game => {
                gameGrid.insertAdjacentHTML('beforeend', `
                    <div class="game-item">
                        <img src="${game.imageURL}" onerror="this.src='https://via.placeholder.com/300x400'">
                        <div class="game-info">
                            <h3 style="font-size:13px;">${game.title}</h3>
                            <button onclick="startDownload('${game.downloadURL}')" class="mini-download-btn">DOWNLOAD</button>
                        </div>
                    </div>`);
            });
            setupPagination();
        }

        function setupPagination() {
            paginationBox.innerHTML = '';
            const totalPages = Math.ceil(allGames.length / limit);
            if(totalPages <= 1) return;
            for(let i = 1; i <= totalPages; i++) {
                const btn = document.createElement('button');
                btn.innerText = i;
                btn.className = (i === currentPage) ? 'page-btn active' : 'page-btn';
                btn.onclick = () => { displayGames(i); window.scrollTo(0,0); };
                paginationBox.appendChild(btn);
            }
        }

        // Search Logic
        searchInput.addEventListener('input', function() {
            const query = this.value.toUpperCase();
            searchDropdown.innerHTML = '';
            if (query.length < 1) { searchDropdown.style.display = 'none'; return; }

            const filtered = allGames.filter(g => g.title.toUpperCase().includes(query)).slice(0, 6);
            if (filtered.length > 0) {
                searchDropdown.style.display = 'block';
                filtered.forEach(game => {
                    const item = document.createElement('div');
                    item.className = 'search-item';
                    item.innerHTML = `<img src="${game.imageURL}"><div><h4>${game.title}</h4><small>${game.size || ''}</small></div>`;
                    item.onclick = () => startDownload(game.downloadURL);
                    searchDropdown.appendChild(item);
                });
            } else { searchDropdown.style.display = 'none'; }
        });

        // Timer Function
        window.startDownload = (link) => {
            const overlay = document.getElementById('download-overlay');
            const countDisplay = document.getElementById('seconds-count');
            overlay.style.display = 'flex';
            let time = 10;
            const timer = setInterval(() => {
                time--;
                countDisplay.innerText = time;
                if(time <= 0) {
                    clearInterval(timer);
                    window.location.href = link;
                    setTimeout(() => overlay.style.display = 'none', 2000);
                }
            }, 1000);
        };

        // Auth
        window.userLogout = () => signOut(auth);
        window.toggleAuth = () => {
            if (auth.currentUser) {
                const pc = document.getElementById('profileCard');
                pc.style.display = pc.style.display === 'flex' ? 'none' : 'flex';
            } else {
                signInWithPopup(auth, provider);
            }
        };

        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById('userName').innerText = user.displayName.split(' ')[0].toUpperCase();
                document.getElementById('userImg').src = user.photoURL;
                document.getElementById('cardImg').src = user.photoURL;
                document.getElementById('cardName').innerText = user.displayName;
                document.getElementById('cardEmail').innerText = user.email;
            } else {
                document.getElementById('userName').innerText = "LOGIN";
                document.getElementById('userImg').src = "https://cdn-icons-png.flaticon.com/512/149/149071.png";
                document.getElementById('profileCard').style.display = 'none';
            }
        });

        // Close search on click outside
        document.addEventListener('click', (e) => { if (!searchInput.contains(e.target)) searchDropdown.style.display = 'none'; });
    </script>
</body>
</html>
